<!DOCTYPE html>
<html>
  <head>
    <title>Hunt Canvas</title>
    <script src = "./jquery-3.3.1.min.js"></script>
    <script src="https://cdn.rawgit.com/konvajs/konva/2.0.3/konva.min.js"></script>
    <script>
      var clues = new Array();
      var lastKnownClue;
      $(document).ready(function(){
        $('#side-bar-menu').load("./sidebar.html");
        $('#add-clue-container button').click(drawClue);

      });

      function onClueDrag(event){
        alert("dragging")
        if(isClueClicked() != -1){
          alert("dragging a clue");
        }
      }

      function throwClue(clue){
        clue.context.clearRect(clue.xPos - (clue.radius + 10),clue.yPos - (clue.radius + 10),clue.radius*2.5,clue.radius*2.5);
      }

      function isClueClicked(){
        var bounds = document.getElementById("canvas").getBoundingClientRect();
        var x = e.clientX - bounds.left;
        var y = e.clientY - bounds.top;

        for(var i=0;i<clues.length;i++){
          if(x + clues[i].radius >= clues[i].xPos && x - clues[i].radius <= clues[i].xPos &&
            y + clues[i].radius >= clues[i].yPos && y - clues[i].radius <= clues[i].yPos){
              return i;
          }
        }
        return -1;
      }

      function Clue(){
        this.radius = 35;
        this.xPos = 500;
        this.yPos = 300;
        this.clueNumber = function(){
          if(clues.length == 0 || clues.length == 1){
            return 1;
          }else{
            return clues.length;
          }
        }
      }
      function drawClue(){
        var canvas = document.getElementById("canvas");
        var context = canvas.getContext("2d");
        context.font = "30px Arial";
        context.lineWidth = 5;
        context.beginPath();
        var clue = new Clue();
        context.arc(clue.xPos,clue.yPos,clue.radius,0,2*Math.PI);
        context.shadowOffsetX = 3;
        context.shadowOffsetY = 2;
        context.shadowBlur = 20;
        context.shadowColor = "black";
        context.stroke();
        clue.number = clue.clueNumber();
        context.fillText(clue.number,clue.xPos - 8.5,clue.yPos + 8.5);
        clue.context = context;
        clues.push(clue);
      }
    </script>
    <style>
      .horizontal-container{
        display: inline-block;
      }
      #title{
        background-color: #724403;
        color: white;
        padding: 1%;
        width: 78.5vw;
        font-family: baby-love;
        border-style: solid;
        border-color: black;
        border-width: thin;
      }
      #page-content-container{
        position: absolute;
        margin-left: 2vw;
      }
      #canvas{
        border-style: solid;
      }
      .box-content{
        border: dashed;
        width: 80vw;
        color: #bec4ce;
      }

      #add-clue-container button{
        float:right;
        border:none;
        color: white;
        background-color: green;
        font-size: 15px;
        margin-right: 4%;
        margin-bottom: 1%;
        border-radius: 5px;
      }
      #side-section{
        border-style: dashed;
        width: 15vw;
        height:48vh;
        margin-top: 1%;
      }
      #side-section-title{
        font-weight: bold;
        font-family: digital-letters;
        font-size: 25px;
        color:#193666;
      }

    </style>
  </head>
  <body>
    <div id = "side-bar-menu" class = "horizontal-container"></div>
    <div id = "page-content-container" class = "horizontal-container">
      <h1 id = "title">Welcome to the hunt canvas</h1>
      <span id = "add-clue-container"><button class = "glyphicon">&#x2b;<span> ADD A CLUE</span></button></span>
      <canvas id = "canvas" width = "1000" height = "600" ondrag = "onClueDrag(event)"></canvas>
      <h2 id = "hunt-history-title">History</h2>
      <div id = "hunt-history" class = "box-content">
        No History.
      </div>
    </div>
    <div id = "side-section">
      <span id = "side-section-title">Active Hunt</span>
      <hr/>
      <div id = "side-section-content">no hunts are active.</div>
    </div>
  </body>
</html>
