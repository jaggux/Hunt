<!DOCTYPE html>
<html>
  <head>
    <title>Hunt Canvas</title>
    <link href = "http://code.jquery.com/ui/1.12.1/themes/ui-lightness/jquery-ui.css" rel = "stylesheet" type = "text/css"/>
    <script src = "./jquery-3.3.1.min.js"></script>
    <script src = "./cytoscape.min.js"></script>
    <script src="https://cdn.rawgit.com/konvajs/konva/2.0.3/konva.min.js"></script>
    <script src="http://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
   crossorigin="anonymous"></script>

    <script>
      var clues = new Array();
      var lastKnownClue;
      var layer = new Konva.Layer();
      var WIDTH = window.innerWidth * 0.80;
      var HEIGHT = window.innerHeight * 0.79;
      var centerX;
      var centerY;

      $(document).ready(function(){
        $('#side-bar-menu').load("./sidebar.html");

        $('#dialog-form').dialog({
          autoOpen:false,
          position:{
            me:'center',
            at:'center',
            of: window
          },
          title:"clue-builder",
          modal:true,
          buttons:{
            "pin-it":function(){

            },
            "cancel":function(){
              $(this).dialog("close");
            }
          }
        });
        $('#control-buttons-container button').click(function(){
          $('#dialog-form').dialog("open");
        });
        /*var cy = cytoscape({
          container: $('#canvas'),
          elements:[
            {data:{id:'a'}},
            {data:{id:'b'}},
            {
              data: {
                id: 'ab',
                source: 'a',
                target: 'b'
              }
            }
          ],
          style:[{
            selector:'node',
            style:{
              shape: 'circle',
              'background-color':'white',
              'border-color': 'blue',
              'border-width':3,
              'width':50,
              'height':50,
              label: 'data(id)',
              'text-margin-y':'20%'
            }
          }],
          layout:{
            name: 'grid'
          }
        });

        cy.layout({name:'circle'}).run();*/

        var stage = new Konva.Stage({
          container: "detail-canvas",
          width: WIDTH,
          height: HEIGHT
        });
        centerX = stage.getWidth()/2;
        centerY = stage.getHeight()/2;



      });

      function addClue(clue){
        var group = new Konva.Group({
            draggable: true,
            locx:centerX,
            locy:centerY,
            dragBoundFunc: function(pos){
              var xpos = pos.x;
              var ypos = pos.y;

              if(xpos < -469){
                xpos = -469;
              }else if(xpos > 467){
                xpos = 467;
              }

              if(ypos < -232){
                ypos = -232;
              }else if(ypos > 232){
                ypos = 232;
              }

              return {
                x: xpos,
                y: ypos
              }

            }
        });

        var text = new Konva.Text({
          x:clue.posX - 10,
          y:clue.posY - 15,
          align: "center",
          text: clue.clueNumber(),
          fontSize: 35,

        });
        group.add(text);
        group.add(circle);


        clues.push(group);
        layer.add(group);
      }

      function Clue(title,body,number){
        this.title = title;
        this.body = body;
        this.number = number;
      }

      function textAreaCharacterCount(){
        var count = $('#clue-body-field').val().length;
        $('#dialog-form span').text(count + " character(s)");
      }
    </script>
    <style>
      .horizontal-container{
        display: inline-block;
      }
      #title{
        background-color: #724403;
        color: white;
        padding: 1%;
        width: 80vw;
        font-family: baby-love;
        border-style: solid;
        border-color: black;
        border-width: thin;
      }
      #page-content-container{
        position: absolute;
        margin-left: 2vw;
      }
      #detail-canvas{
        border-style: solid;
        width:80vw;
        height:80vh;
        margin-top:2%;
      }
      .box-content{
        border: dashed;
        width: 80vw;
        color: #bec4ce;
      }
      .view-control-button{
        color:white;
        background-color: #040930;
        border-radius:10px;
        font-family: digital-letters;
      }

      #control-buttons-container button{
        position: relative;
        float:right;
        border:none;
        color: white;
        background-color: green;
        font-size: 15px;
        margin-bottom: 1%;
        border-radius: 5px;
        font-family: digital-letters;
      }
      #side-section{
        border-style: dashed;
        width: 15vw;
        height:48vh;
        margin-top: 1%;
      }
      #side-section-title{
        font-weight: bold;
        font-family: digital-letters;
        font-size: 25px;
        color:#193666;
      }

      #dialog-form .clue-input-fields{
        position:relative;
        width:100%;
      }
      #dialog-form textarea{
        resize: none;
        text-align: left;
      }
      #dialog-form span{
        font-size: 10px;
      }


    </style>
  </head>
  <body>
    <div id = "side-bar-menu" class = "horizontal-container"></div>
    <div id = "page-content-container" class = "horizontal-container">
      <h1 id = "title">Welcome to the hunt canvas</h1>
      <button class = "view-control-button">Detail-View</button>
      <button class = "view-control-button">Graph-View</button>
      <span id = "control-buttons-container">
        <button class = "glyphicon">&#x2b;<span> ADD A CLUE</span></button>
      </span>
      <br/>
      <div id = "detail-canvas"></div>
      <h2 id = "hunt-history-title">History</h2>
      <div id = "hunt-history" class = "box-content">
        No History.
      </div>
      <div id = "dialog-form">
        <form>
          <br/>
          <input class = "clue-input-fields" id = "clue-title-field" name = "clue-title-field" type = "text" placeholder="title..or heading of your clue..."/>
          <span>0 characters</span><br/>
          <textarea id = "clue-body-field" name = "clue-body-field" placeholder="compose your clue here..." cols = "30" rows = "8" oninput="textAreaCharacterCount()"></textarea>
        </form>
      </div>
    </div>
    <div id = "side-section">
      <span id = "side-section-title">Active Hunt</span>
      <hr/>
      <div id = "side-section-content">no hunts are active.</div>
    </div>
  </body>
</html>
